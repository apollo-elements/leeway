<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ü§∑‚Äç‚ôÇÔ∏è Leeway: Chat over GraphQL</title>
    <link rel="stylesheet" href="/style.css">
    <script type="module" src="/bundle.js"></script>
    <script src="/assets/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
  </head>
  <body unresolved>
    <leeway-user-status-toast>
      <script type="application/graphql">
        subscription UserStatusUpdated {
          userStatusUpdated {
            nick
            status
          }
        }
      </script>
    </leeway-user-status-toast>

    <leeway-userlist>
      <info-box heading="About This Demo">
        Leeway is a demo of <code>lit-apollo</code> using GraphQL subscriptions to create a simple chat app.
        The source code is available on <a href="https://gitlab.com/bennyp/demo-lit-apollo-subscriptions">GitLab</a>.
        Alternately, source maps are enabled, so just open dev tools to peruse the source.
      </info-box>

      <script type="application/graphql">
        query Users {
          users {
            nick
            status
          }
        }
      </script>
    </leeway-userlist>

    <leeway-messages>
      <script type="application/graphql">
        query Messages {
          messages {
            date
            message
            user
          }
        }
      </script>
    </leeway-messages>

    <leeway-input>
      <script type="application/graphql">
        mutation sendMessage($user: String, $message: String) {
          sendMessage(user: $user, message: $message) {
            date
            message
            user
          }
        }
      </script>
    </leeway-input>

    <script defer>
      WebComponents.waitFor(async function resolveBody() {
        await Promise.all([
          customElements.whenDefined('leeway-mutation'),
          customElements.whenDefined('leeway-query'),
          customElements.whenDefined('leeway-subscription'),
          customElements.whenDefined('info-box'),
        ])
        document.body.removeAttribute('unresolved');
        document.body.querySelector('leeway-mutation').userInput.focus();
      })
    </script>

  </body>
</html>
